{"openapi":"3.1.0","info":{"title":"Magpie API Documentation","description":"Magpie API for QRPh and Disbursement services","version":"1.0.0"},"paths":{"/v1/qrph/":{"get":{"tags":["QRPh Requests"],"summary":"List QRPh requests","description":"Returns a paginated collection of QRPh requests for the authenticated organization. Use `limit` and `cursor` for pagination and `reference_id` to locate a specific request.","operationId":"list_qrph_v1_qrph__get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"title":"Page size","description":"Number of items to return (1-100).","default":50},"description":"Number of items to return (1-100)."},{"name":"cursor","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cursor","description":"Opaque cursor returned from the previous page for pagination."},"description":"Opaque cursor returned from the previous page for pagination."},{"name":"reference_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter on a specific request reference ID.","title":"Reference Id"},"description":"Filter on a specific request reference ID."},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QRPhCollectionResponse"},"example":{"data":[{"id":"qr_01ka0jjyq6yp4xhv4425","reference_id":"order-410-393","type":"static","amount":100,"status":"paid","metadata":{"driver":"Juan dela Cruz","driver_id":"DRIVER#123"},"qrph_payload":"00020101021128760011ph.ppmi.p2m.qrph...","qrph_image":"data:image/png;base64,iVBORw0KGgo...","checkout_url":"https://checkout.magpiepay.com/c?token=eyJle...","payment_id":"pay_01ka0555mw40ajcdgzn34sg6p5","paid_at":"2025-11-14T03:51:16+00:00","expires_at":"2025-11-14T07:29:30.662982+00:00","created_at":"2025-11-14T06:59:30+00:00","updated_at":"2025-11-14T06:59:30+00:00","livemode":true}],"limit":50,"next_cursor":"cursor_abc"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["QRPh Requests"],"summary":"Create a QRPh request","description":"Creates a QRPh request from the canonical payload and returns the normalized request with the checkout URL attached.","operationId":"create_qrph_v1_qrph__post","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanonicalCreateQRReq"},"example":{"reference_id":"order-2025-11-20","type":"dynamic","amount":2500,"metadata":{"customer_id":"cust_123","notes":"in-store purchase"}}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QRPhSingleResponse"},"example":{"data":{"id":"qr_01ka0jjyq6yp4xhv4425","reference_id":"order-410-393","type":"static","amount":100,"status":"paid","metadata":{"driver":"Juan dela Cruz","driver_id":"DRIVER#123"},"qrph_payload":"00020101021128760011ph.ppmi.p2m.qrph...","qrph_image":"data:image/png;base64,iVBORw0KGgo...","checkout_url":"https://checkout.magpiepay.com/c?token=eyJle...","payment_id":"pay_01ka0555mw40ajcdgzn34sg6p5","paid_at":"2025-11-14T03:51:16+00:00","expires_at":"2025-11-14T07:29:30.662982+00:00","created_at":"2025-11-14T06:59:30+00:00","updated_at":"2025-11-14T06:59:30+00:00","livemode":true}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/qrph/{id}":{"get":{"tags":["QRPh Requests"],"summary":"Get QRPh status","description":"Returns the current QRPh request state, including checkout URLs and payment IDs.","operationId":"get_qrph_status_v1_qrph__id__get","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","title":"Id"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QRPhSingleResponse"},"example":{"data":{"id":"qr_01ka0jjyq6yp4xhv4425","reference_id":"order-410-393","type":"static","amount":100,"status":"paid","metadata":{"driver":"Juan dela Cruz","driver_id":"DRIVER#123"},"qrph_payload":"00020101021128760011ph.ppmi.p2m.qrph...","qrph_image":"data:image/png;base64,iVBORw0KGgo...","checkout_url":"https://checkout.magpiepay.com/c?token=eyJle...","payment_id":"pay_01ka0555mw40ajcdgzn34sg6p5","paid_at":"2025-11-14T03:51:16+00:00","expires_at":"2025-11-14T07:29:30.662982+00:00","created_at":"2025-11-14T06:59:30+00:00","updated_at":"2025-11-14T06:59:30+00:00","livemode":true}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/qrph/{id}/cancel":{"post":{"tags":["QRPh Requests"],"summary":"Cancel a QRPh request","description":"Cancels the specified QRPh request and returns the updated request record.","operationId":"cancel_qrph_v1_qrph__id__cancel_post","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","title":"Id"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/CancelQRPhRequest"},{"type":"null"}],"title":"Payload"},"example":{"cancellation_reason":"Customer requested refund"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/QRPhSingleResponse"},"example":{"data":{"id":"qr_01ka0jjyq6yp4xhv4425","reference_id":"order-410-393","type":"static","amount":100,"status":"paid","metadata":{"driver":"Juan dela Cruz","driver_id":"DRIVER#123"},"qrph_payload":"00020101021128760011ph.ppmi.p2m.qrph...","qrph_image":"data:image/png;base64,iVBORw0KGgo...","checkout_url":"https://checkout.magpiepay.com/c?token=eyJle...","payment_id":"pay_01ka0555mw40ajcdgzn34sg6p5","paid_at":"2025-11-14T03:51:16+00:00","expires_at":"2025-11-14T07:29:30.662982+00:00","created_at":"2025-11-14T06:59:30+00:00","updated_at":"2025-11-14T06:59:30+00:00","livemode":true}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/payments/":{"get":{"tags":["Payments"],"summary":"List payments","description":"Returns a paginated list of QRPh payments for the authenticated organization.","operationId":"list_payments_v1_payments__get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"title":"Page size","description":"Number of payments to return (1-100).","default":50},"description":"Number of payments to return (1-100)."},{"name":"cursor","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cursor","description":"Cursor returned from the previous page."},"description":"Cursor returned from the previous page."},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentCollectionResponse"},"example":{"data":[{"id":"pay_01ka06q2p53vbm70pvgjc2vbcf","qrph_id":"qr_01k9m4e0jhxasgscks9f","status":"paid","amount":22000,"magpie_mdr":"0.015","magpie_fee":330,"merchant_net_amount":21670,"payment_source":"gcash","paid_at":"2025-11-14T03:52:17+00:00","created_at":"2025-11-14T03:32:02+00:00","updated_at":"2025-11-14T03:32:02+00:00","livemode":true}],"limit":50,"next_cursor":"cursor_abc"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/payments/{payment_id}":{"get":{"tags":["Payments"],"summary":"Get payment","description":"Retrieve the current state of a QRPh payment.","operationId":"get_payment_v1_payments__payment_id__get","parameters":[{"name":"payment_id","in":"path","required":true,"schema":{"type":"string","title":"Payment Id"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentSingleResponse"},"example":{"data":{"id":"pay_01ka06q2p53vbm70pvgjc2vbcf","qrph_id":"qr_01k9m4e0jhxasgscks9f","status":"paid","amount":22000,"magpie_mdr":"0.015","magpie_fee":330,"merchant_net_amount":21670,"payment_source":"gcash","paid_at":"2025-11-14T03:52:17+00:00","created_at":"2025-11-14T03:32:02+00:00","updated_at":"2025-11-14T03:32:02+00:00","livemode":true}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/payouts/":{"post":{"tags":["Payouts"],"summary":"Create a payout","description":"Initiates a payout using a canonical payload and returns the normalized payout record.","operationId":"create_payout_v1_payouts__post","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayoutCreateRequest"},"example":{"reference_id":"PAYOUT-123-456","channel":"instapay","amount":40000,"source_account_id":"act_01k90z02ps251323zgkd23cb0d","destination":{"first_name":"Juan","last_name":"Dela Cruz","bank_code":"bdo","account_number":"002400091125"},"purpose":"Salary payout"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayoutSingleResponse"},"example":{"data":{"id":"po_01k9m4hs4bggbnhg61hdacrr7w","reference_id":"PAYOUT-123-456","channel":"instapay","amount":40000,"magpie_fee":600,"source_account_id":"act_01k9k6w2f33ge10qxfp7p18dqh","destination":{"bank_code":"bdo","account_number":"002400091125","last_name":"Dela Cruz","first_name":"Juan"},"purpose":"Salary payout","status":"processing","provider_ref":{},"metadata":{},"created_at":"2025-11-09T11:03:18+00:00","updated_at":"2025-11-09T11:03:18+00:00","failure_code":"0","livemode":true}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Payouts"],"summary":"List payouts","description":"Returns a paginated collection of payouts for the authenticated organization.","operationId":"list_payouts_v1_payouts__get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"title":"Page size","description":"Number of payouts to return (1-100).","default":50},"description":"Number of payouts to return (1-100)."},{"name":"cursor","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cursor","description":"Cursor returned from the previous page."},"description":"Cursor returned from the previous page."},{"name":"reference_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter payouts by reference ID.","title":"Reference Id"},"description":"Filter payouts by reference ID."},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayoutCollectionResponse"},"example":{"data":[{"id":"po_01k9m4hs4bggbnhg61hdacrr7w","reference_id":"PAYOUT-123-456","channel":"instapay","amount":40000,"magpie_fee":600,"source_account_id":"act_01k9k6w2f33ge10qxfp7p18dqh","destination":{"bank_code":"bdo","account_number":"002400091125","last_name":"Dela Cruz","first_name":"Juan"},"purpose":"Salary payout","status":"processing","provider_ref":{},"metadata":{},"created_at":"2025-11-09T11:03:18+00:00","updated_at":"2025-11-09T11:03:18+00:00","failure_code":"0","livemode":true}],"limit":50,"next_cursor":"cursor_abc"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/payouts/{payout_id}":{"get":{"tags":["Payouts"],"summary":"Get payout","description":"Retrieves the latest state for a payout.","operationId":"get_payout_v1_payouts__payout_id__get","parameters":[{"name":"payout_id","in":"path","required":true,"schema":{"type":"string","title":"Payout Id"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayoutSingleResponse"},"example":{"data":{"id":"po_01k9m4hs4bggbnhg61hdacrr7w","reference_id":"PAYOUT-123-456","channel":"instapay","amount":40000,"magpie_fee":600,"source_account_id":"act_01k9k6w2f33ge10qxfp7p18dqh","destination":{"bank_code":"bdo","account_number":"002400091125","last_name":"Dela Cruz","first_name":"Juan"},"purpose":"Salary payout","status":"processing","provider_ref":{},"metadata":{},"created_at":"2025-11-09T11:03:18+00:00","updated_at":"2025-11-09T11:03:18+00:00","failure_code":"0","livemode":true}}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/references/bank_codes":{"get":{"tags":["References"],"summary":"List Bank Codes","operationId":"list_bank_codes_v1_references_bank_codes_get","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}},{"name":"Authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BankCodeCollection"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"BankCodeCollection":{"properties":{"data":{"items":{"$ref":"#/components/schemas/BankCodeEntry"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"BankCodeCollection"},"BankCodeEntry":{"properties":{"code":{"type":"string","title":"Code"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name","description":"Human-friendly display name"}},"type":"object","required":["code"],"title":"BankCodeEntry"},"CancelQRPhRequest":{"properties":{"cancellation_reason":{"anyOf":[{"type":"string","maxLength":200},{"type":"null"}],"title":"Cancellation Reason","description":"Optional explanation for cancelling the QRPh request."}},"type":"object","title":"CancelQRPhRequest"},"CanonicalCreateQRReq":{"properties":{"reference_id":{"type":"string","maxLength":20,"title":"Reference Id","description":"Client-provided identifier used to correlate the QRPh request."},"type":{"type":"string","enum":["static","dynamic"],"title":"Type","description":"QR type, dynamic for fixed payments or static for amount-less flows."},"amount":{"anyOf":[{"type":"integer","maximum":5000000.0},{"type":"null"}],"title":"Amount","description":"Amount in centavos (omit for dynamic QR)."},"submerchant_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Submerchant Id","description":"Optional sub-merchant identifier when the request belongs to a marketplace or aggregator partner."},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata","description":"Free-form metadata that will be copied into the QRPh response."}},"type":"object","required":["reference_id","type"],"title":"CanonicalCreateQRReq"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"PaymentCollectionResponse":{"properties":{"data":{"items":{"$ref":"#/components/schemas/PaymentResponse"},"type":"array","title":"Data"},"limit":{"type":"integer","title":"Limit"},"next_cursor":{"type":"string","title":"Next Cursor"}},"type":"object","required":["data","limit","next_cursor"],"title":"PaymentCollectionResponse"},"PaymentResponse":{"properties":{"id":{"type":"string","title":"Id","description":"Unique identifier for the payment record."},"qrph_id":{"type":"string","title":"Qrph Id","description":"Associated QRPh request identifier."},"status":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status","description":"Payment status."},"amount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Amount","description":"Amount in centavos."},"magpie_mdr":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Magpie Mdr","description":"Magpie’s MDR percentage."},"magpie_fee":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Magpie Fee","description":"Magpie’s fixed fee in centavos."},"merchant_net_amount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Merchant Net Amount","description":"Merchant net amount after fees."},"payment_source":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Payment Source","description":"Source used to make the payment."},"paid_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Paid At","description":"ISO timestamp when the payment was settled."},"created_at":{"type":"string","title":"Created At","description":"ISO timestamp when the payment record was created."},"updated_at":{"type":"string","title":"Updated At","description":"ISO timestamp when the payment record was last updated."},"livemode":{"type":"boolean","title":"Livemode","description":"Whether the payment was processed in live mode."}},"additionalProperties":true,"type":"object","required":["id","qrph_id","created_at","updated_at","livemode"],"title":"PaymentResponse"},"PaymentSingleResponse":{"properties":{"data":{"$ref":"#/components/schemas/PaymentResponse"}},"type":"object","required":["data"],"title":"PaymentSingleResponse"},"PayoutCollectionResponse":{"properties":{"data":{"items":{"$ref":"#/components/schemas/PayoutResponse"},"type":"array","title":"Data"},"limit":{"type":"integer","title":"Limit"},"next_cursor":{"type":"string","title":"Next Cursor"}},"type":"object","required":["data","limit","next_cursor"],"title":"PayoutCollectionResponse"},"PayoutCreateRequest":{"properties":{"reference_id":{"type":"string","minLength":1,"title":"Reference Id","description":"Client-provided reference for the payout."},"channel":{"type":"string","enum":["instapay","pesonet"],"title":"Channel","description":"Channel to use for the payout."},"amount":{"type":"integer","exclusiveMinimum":0.0,"title":"Amount","description":"Amount in centavos."},"source_account_id":{"type":"string","minLength":1,"title":"Source Account Id","description":"Org bank account ID to debit."},"destination":{"$ref":"#/components/schemas/PayoutDestination","description":"Destination account details."},"purpose":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Purpose","description":"Optional description of the payout."},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata","description":"Optional metadata stored with the payout."}},"type":"object","required":["reference_id","channel","amount","source_account_id","destination"],"title":"PayoutCreateRequest"},"PayoutDestination":{"properties":{"first_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"First Name","description":"Beneficiary given name."},"last_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Name","description":"Beneficiary family name."},"bank_code":{"type":"string","title":"Bank Code","description":"Bank code for the beneficiary account."},"account_number":{"type":"string","title":"Account Number","description":"Beneficiary account number."}},"type":"object","required":["bank_code","account_number"],"title":"PayoutDestination"},"PayoutDestinationResponse":{"properties":{"first_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"First Name","description":"Beneficiary given name returned by the provider."},"last_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Name","description":"Beneficiary family name returned by the provider."},"bank_code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Bank Code","description":"Bank code echoed back from the provider."},"account_number":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Account Number","description":"Account number echoed back from the provider."}},"type":"object","title":"PayoutDestinationResponse"},"PayoutResponse":{"properties":{"id":{"type":"string","title":"Id","description":"Unique payout identifier."},"reference_id":{"type":"string","title":"Reference Id","description":"Client-provided reference tying to the payout request."},"channel":{"type":"string","title":"Channel","description":"Payment channel (instapay/pesonet)."},"amount":{"type":"integer","title":"Amount","description":"Amount in centavos."},"magpie_fee":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Magpie Fee","description":"Magpie’s fee in centavos."},"source_account_id":{"type":"string","title":"Source Account Id","description":"Org bank account used as source."},"destination":{"$ref":"#/components/schemas/PayoutDestinationResponse","description":"Destination bank account data."},"purpose":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Purpose","description":"Optional payout purpose text."},"status":{"type":"string","title":"Status","description":"Current status of the payout."},"provider":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Provider","description":"Provider the payout hit."},"provider_ref":{"additionalProperties":true,"type":"object","title":"Provider Ref","description":"Provider-specific reference data."},"provider_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Provider Message","description":"Provider-supplied status message."},"metadata":{"additionalProperties":true,"type":"object","title":"Metadata","description":"Merchant-defined metadata."},"created_at":{"type":"string","title":"Created At","description":"ISO timestamp when payout was created."},"updated_at":{"type":"string","title":"Updated At","description":"ISO timestamp when the payout was last modified."},"posted_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Posted At","description":"Timestamp when the payout was posted to the provider."},"completed_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Completed At","description":"Timestamp when payout completed."},"failed_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Failed At","description":"Timestamp when payout failed."},"failure_code":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Failure Code","description":"Provider-supplied failure code."},"failure_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Failure Message","description":"Provider-supplied failure message."},"livemode":{"type":"boolean","title":"Livemode","description":"True when the payout was created in live mode."}},"additionalProperties":true,"type":"object","required":["id","reference_id","channel","amount","source_account_id","destination","status","created_at","updated_at","livemode"],"title":"PayoutResponse"},"PayoutSingleResponse":{"properties":{"data":{"$ref":"#/components/schemas/PayoutResponse"}},"type":"object","required":["data"],"title":"PayoutSingleResponse"},"QRPhCollectionResponse":{"properties":{"data":{"items":{"$ref":"#/components/schemas/QRPhResponse"},"type":"array","title":"Data"},"limit":{"type":"integer","title":"Limit"},"next_cursor":{"type":"string","title":"Next Cursor"}},"type":"object","required":["data","limit","next_cursor"],"title":"QRPhCollectionResponse"},"QRPhResponse":{"properties":{"id":{"type":"string","title":"Id","description":"Unique identifier for the QRPh request."},"reference_id":{"type":"string","title":"Reference Id","description":"Client-provided reference for correlating the request."},"type":{"type":"string","enum":["static","dynamic"],"title":"Type","description":"QR code type, either static or dynamic."},"amount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Amount","description":"Amount requested in centavos (omitted for unpaid dynamic QRs)."},"submerchant_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Submerchant Id","description":"Sub-merchant identifier when the QRPh request is scoped to a marketplace or aggregator partner."},"status":{"type":"string","enum":["active","paid","cancelled","expired"],"title":"Status","description":"Current status of the QRPh request."},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata","description":"Optional key-value payload provided by the merchant for context."},"qrph_payload":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Qrph Payload","description":"Raw QR payload produced by the provider."},"qrph_image":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Qrph Image","description":"Base64-encoded QR image suitable for rendering."},"checkout_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Checkout Url","description":"Checkout URL that directs a payer to the Magpie-hosted payment page."},"payment_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Payment Id","description":"Associated payment identifier once the QR has been paid."},"paid_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Paid At","description":"ISO timestamp when the payment was paid."},"expires_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Expires At","description":"ISO timestamp when the QRPh request becomes invalid."},"cancelled_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cancelled At","description":"ISO timestamp when the QRPh request was cancelled."},"cancellation_reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cancellation Reason","description":"Reason provided when cancelling the QRPh request."},"created_at":{"type":"string","title":"Created At","description":"ISO timestamp when the QRPh request was created."},"updated_at":{"type":"string","title":"Updated At","description":"ISO timestamp when the QRPh request was last updated."},"livemode":{"type":"boolean","title":"Livemode","description":"Indicates whether the request was created in live or test mode."}},"additionalProperties":true,"type":"object","required":["id","reference_id","type","status","created_at","updated_at","livemode"],"title":"QRPhResponse"},"QRPhSingleResponse":{"properties":{"data":{"$ref":"#/components/schemas/QRPhResponse"}},"type":"object","required":["data"],"title":"QRPhSingleResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"ApiError":{"title":"ApiError","type":"object","required":["code","message","request_id"],"properties":{"code":{"type":"string","description":"Stable kebab-case identifier for the error."},"message":{"type":"string","description":"Human readable summary of what went wrong."},"details":{"type":"object","description":"Optional machine readable context for the error.","additionalProperties":true},"request_id":{"type":"string","format":"uuid","description":"Correlation identifier attached to the request/response."}},"examples":[{"code":"validation-error","message":"Request validation failed.","request_id":"00000000-0000-0000-0000-000000000000","details":{"errors":[{"loc":["body","payload","reference_id"],"msg":"field required","type":"missing"}]}},{"code":"unauthorized","message":"Authentication credentials were missing or invalid.","request_id":"00000000-0000-0000-0000-000000000000","details":{"reason":"missing-api-key"}},{"code":"forbidden","message":"You do not have permission to perform this action.","request_id":"00000000-0000-0000-0000-000000000000","details":{"required_scope":"qrph:write"}},{"code":"not-found","message":"The requested resource could not be found.","request_id":"00000000-0000-0000-0000-000000000000","details":{"resource":"qrph-request","identifier":"qr_123"}},{"code":"conflict","message":"The request could not be completed due to a conflict.","request_id":"00000000-0000-0000-0000-000000000000","details":{"resource":"org","field":"email"}},{"code":"rate-limited","message":"Too many requests were made in a short period of time.","request_id":"00000000-0000-0000-0000-000000000000","details":{"retry_after_seconds":5}},{"code":"provider-timeout","message":"The upstream provider did not respond in time.","request_id":"00000000-0000-0000-0000-000000000000","details":{"provider":"ALLBANK","timeout_seconds":30}},{"code":"provider-rejected","message":"The upstream provider rejected the request.","request_id":"00000000-0000-0000-0000-000000000000","details":{"provider":"ALLBANK","provider_code":"QRP-1234"}},{"code":"downstream-bad-request","message":"We sent a bad request to a downstream provider.","request_id":"00000000-0000-0000-0000-000000000000","details":{"provider":"ALLBANK","reason":"Invalid amount format"}},{"code":"internal-error","message":"An unexpected error occurred.","request_id":"00000000-0000-0000-0000-000000000000"}]}},"examples":{"validation-error":{"summary":"Validation Error","value":{"code":"validation-error","message":"Request validation failed.","request_id":"00000000-0000-0000-0000-000000000000","details":{"errors":[{"loc":["body","payload","reference_id"],"msg":"field required","type":"missing"}]}}},"unauthorized":{"summary":"Unauthorized","value":{"code":"unauthorized","message":"Authentication credentials were missing or invalid.","request_id":"00000000-0000-0000-0000-000000000000","details":{"reason":"missing-api-key"}}},"forbidden":{"summary":"Forbidden","value":{"code":"forbidden","message":"You do not have permission to perform this action.","request_id":"00000000-0000-0000-0000-000000000000","details":{"required_scope":"qrph:write"}}},"not-found":{"summary":"Not Found","value":{"code":"not-found","message":"The requested resource could not be found.","request_id":"00000000-0000-0000-0000-000000000000","details":{"resource":"qrph-request","identifier":"qr_123"}}},"conflict":{"summary":"Conflict","value":{"code":"conflict","message":"The request could not be completed due to a conflict.","request_id":"00000000-0000-0000-0000-000000000000","details":{"resource":"org","field":"email"}}},"rate-limited":{"summary":"Rate Limited","value":{"code":"rate-limited","message":"Too many requests were made in a short period of time.","request_id":"00000000-0000-0000-0000-000000000000","details":{"retry_after_seconds":5}}},"provider-timeout":{"summary":"Provider Timeout","value":{"code":"provider-timeout","message":"The upstream provider did not respond in time.","request_id":"00000000-0000-0000-0000-000000000000","details":{"provider":"ALLBANK","timeout_seconds":30}}},"provider-rejected":{"summary":"Provider Rejected","value":{"code":"provider-rejected","message":"The upstream provider rejected the request.","request_id":"00000000-0000-0000-0000-000000000000","details":{"provider":"ALLBANK","provider_code":"QRP-1234"}}},"downstream-bad-request":{"summary":"Downstream Bad Request","value":{"code":"downstream-bad-request","message":"We sent a bad request to a downstream provider.","request_id":"00000000-0000-0000-0000-000000000000","details":{"provider":"ALLBANK","reason":"Invalid amount format"}}},"internal-error":{"summary":"Internal Error","value":{"code":"internal-error","message":"An unexpected error occurred.","request_id":"00000000-0000-0000-0000-000000000000"}}},"securitySchemes":{"basicAuth":{"type":"http","scheme":"basic","description":"Use Basic authentication where the API key is the username and the password is empty. Send `Authorization: Basic <base64(api_key:)>`."}}},"tags":[{"name":"QRPh Requests","description":"QRPh requests allow merchants to generate payment QR codes that customers can scan using any QRPh-compliant wallet or banking app. When a merchant initiates a QR generation request, the system returns the QR data needed to create a scannable QR image. This QR can be dynamic (unique per transaction) or static (reusable). Merchants may also request updates such as checking if the QR has already been paid or canceling a QR that should no longer be used."},{"name":"Payments","description":"Payments are processed when the customer scans the QR code and approves the payment using their financial app. The payment is routed through the customer’s bank or e-wallet and validated through the national QRPh network. Once the transaction is completed, the merchant receives a real-time callback notification containing the payment amount, payment channel, timestamps, and confirmation message."},{"name":"Payouts","description":"The payout service allows partners to send funds from their disbursement account to any participating bank or e-wallet in the Philippines. Two clearing networks are supported—InstaPay and PESONet—giving partners flexibility depending on speed and transaction value.<br/><br/>InstaPay enables real-time, low-value transfers of up to ₱50,000 per transaction. Funds are processed instantly and typically reach the recipient within seconds. This is ideal for time-sensitive disbursements such as customer refunds, driver or rider payouts, incentives, or wallet top-ups.,<br/><br/>PESONet supports larger-value or batch transfers processed according to the network’s scheduled clearing cycle. It is suited for bulk payouts, salary runs, vendor payments, and other high-value transfers where same-day or next-day posting is acceptable."}],"x-magpie-error-catalog":[{"code":"validation-error","status":422,"message":"Request validation failed.","details":{"errors":[{"loc":["body","payload","reference_id"],"msg":"field required","type":"missing"}]}},{"code":"unauthorized","status":401,"message":"Authentication credentials were missing or invalid.","details":{"reason":"missing-api-key"}},{"code":"forbidden","status":403,"message":"You do not have permission to perform this action.","details":{"required_scope":"qrph:write"}},{"code":"not-found","status":404,"message":"The requested resource could not be found.","details":{"resource":"qrph-request","identifier":"qr_123"}},{"code":"conflict","status":409,"message":"The request could not be completed due to a conflict.","details":{"resource":"org","field":"email"}},{"code":"rate-limited","status":429,"message":"Too many requests were made in a short period of time.","details":{"retry_after_seconds":5}},{"code":"provider-timeout","status":504,"message":"The upstream provider did not respond in time.","details":{"provider":"ALLBANK","timeout_seconds":30}},{"code":"provider-rejected","status":502,"message":"The upstream provider rejected the request.","details":{"provider":"ALLBANK","provider_code":"QRP-1234"}},{"code":"downstream-bad-request","status":502,"message":"We sent a bad request to a downstream provider.","details":{"provider":"ALLBANK","reason":"Invalid amount format"}},{"code":"internal-error","status":500,"message":"An unexpected error occurred."}],"x-magpie-provider-errors":{"allbank":{"return_codes":{"instapay":{"411":{"magpie_code":"provider_maintenance","magpie_message":"AllBank is performing maintenance. Please retry the payout shortly.","provider_message":"Service Maintenance, please try again later"},"412":{"magpie_code":"provider_maintenance","magpie_message":"AllBank is performing maintenance. Please retry the payout shortly.","provider_message":"Ongoing Maintenance, please try again later"},"413":{"magpie_code":"destination_bank_maintenance","magpie_message":"The receiving bank is offline for maintenance. Please try again later.","provider_message":"Destination Bank is on scheduled maintenance until <TimeEnd>"},"414":{"magpie_code":"duplicate_payout","magpie_message":"AllBank flagged this payout as a duplicate. Use a new reference and retry.","provider_message":"Duplicate transaction"},"415":{"magpie_code":"invalid_destination","magpie_message":"AllBank could not validate the beneficiary account. Please double-check the details.","provider_message":"Invalid destination details"},"416":{"magpie_code":"same_source_destination","magpie_message":"Source and destination accounts must be different for this payout.","provider_message":"You are not allowed to send to your own bank"},"420":{"magpie_code":"insufficient_funds","magpie_message":"The funding account does not have enough balance for this payout.","provider_message":"Source Acct. Insufficient Txn Amt."},"425":{"magpie_code":"invalid_reference","magpie_message":"AllBank could not find this reference ID. Submit a new payout reference.","provider_message":"Invalid Reference ID"},"2":{"magpie_code":"authentication_failed","magpie_message":"AllBank rejected our credentials. Please contact Magpie support.","provider_message":"Access Denied"}},"pesonet":{"431":{"magpie_code":"duplicate_payout","magpie_message":"AllBank flagged this payout as a duplicate. Use a new reference and retry.","provider_message":"Duplicate transaction."},"432":{"magpie_code":"invalid_destination","magpie_message":"AllBank could not validate the beneficiary account. Please double-check the details.","provider_message":"Invalid destination details"},"433":{"magpie_code":"same_source_destination","magpie_message":"Source and destination accounts must be different for this payout.","provider_message":"You are not allowed to send to your own bank."},"434":{"magpie_code":"account_in_use","magpie_message":"The receiving account is busy. Wait a few minutes and retry the payout.","provider_message":"Account being used, please try again later."},"435":{"magpie_code":"posting_failed","magpie_message":"AllBank could not post this payout. We are reviewing the issue.","provider_message":"Post PE:<post_result> EN: <casa_error_no> : <msg>"},"441":{"magpie_code":"invalid_reference","magpie_message":"AllBank could not find this reference ID. Submit a new payout reference.","provider_message":"Invalid Reference ID"},"2":{"magpie_code":"authentication_failed","magpie_message":"AllBank rejected our credentials. Please contact Magpie support.","provider_message":"Access Denied"}},"intrabank":{"414":{"magpie_code":"duplicate_payout","magpie_message":"AllBank flagged this payout as a duplicate. Use a new reference and retry.","provider_message":"Duplicate transaction"},"420":{"magpie_code":"insufficient_funds","magpie_message":"The funding account does not have enough balance for this payout.","provider_message":"Source Acct. Insufficient Txn Amt."},"467":{"magpie_code":"invalid_amount","magpie_message":"The payout amount is invalid for this channel. Please review the limits.","provider_message":"Invalid Amount"},"468":{"magpie_code":"invalid_destination","magpie_message":"AllBank could not validate the beneficiary account. Please double-check the details.","provider_message":"Invalid Destination AcctNo."},"469":{"magpie_code":"amount_exceeds_limit","magpie_message":"The payout exceeds AllBank's limit for this channel.","provider_message":"Invalid Amount: Maximum exceeded"},"470":{"magpie_code":"invalid_source_account","magpie_message":"The funding account is not allowed for this type of payout.","provider_message":"Invalid Source Account, not within Own Account"},"471":{"magpie_code":"invalid_reference","magpie_message":"AllBank could not find this reference ID. Submit a new payout reference.","provider_message":"Invalid Reference ID"},"2":{"magpie_code":"authentication_failed","magpie_message":"AllBank rejected our credentials. Please contact Magpie support.","provider_message":"Access Denied"}}},"status_hints":{"transactionforbidden":{"magpie_code":"provider_rejected","magpie_message":"AllBank rejected this payout. Contact support if the issue persists."},"amountexceedsagreedlimit":{"magpie_code":"amount_exceeds_limit","magpie_message":"The payout exceeds AllBank's limit for this channel."},"banksystemprocessingerror":{"magpie_code":"provider_processing_error","magpie_message":"AllBank encountered a processing issue. We will retry automatically."},"transmissonaborted":{"magpie_code":"provider_transport_error","magpie_message":"AllBank aborted the transfer. Please retry the payout."},"invalid file format":{"magpie_code":"invalid_payload_format","magpie_message":"AllBank could not understand the payout payload. Please contact support."},"syntaxerror":{"magpie_code":"invalid_payload_format","magpie_message":"AllBank could not understand the payout payload. Please contact support."},"closedaccountnumber":{"magpie_code":"destination_account_closed","magpie_message":"The receiving account is closed. Confirm the beneficiary details."},"orderrejected":{"magpie_code":"provider_rejected","magpie_message":"AllBank rejected this payout. Contact support if the issue persists."},"transactionnotsupported":{"magpie_code":"transaction_not_supported","magpie_message":"This payout type is not supported for the receiving bank."},"duplicatepayment":{"magpie_code":"duplicate_payout","magpie_message":"AllBank flagged this payout as a duplicate. Use a new reference and retry."},"invalidcreditorbankidentifier":{"magpie_code":"invalid_destination_bank","magpie_message":"The receiving bank identifier is invalid or not supported."},"waitingtimeexpired":{"magpie_code":"provider_timeout","magpie_message":"AllBank timed out while routing the payout. Please retry."},"incorrectaccountnumber":{"magpie_code":"invalid_destination","magpie_message":"AllBank could not validate the beneficiary account. Please double-check the details."},"invalidcreditoraccountnumber":{"magpie_code":"invalid_destination","magpie_message":"AllBank could not validate the beneficiary account. Please double-check the details."},"blockedaccount":{"magpie_code":"destination_account_blocked","magpie_message":"The receiving account is blocked. Ask the beneficiary to contact their bank."},"invalidcutofftime":{"magpie_code":"past_cutoff","magpie_message":"This payout was submitted after AllBank's cutoff window."},"offlinecreditoragent":{"magpie_code":"destination_bank_offline","magpie_message":"The receiving bank is offline. Please retry later."},"receiving bank - logged off":{"magpie_code":"destination_bank_offline","magpie_message":"The receiving bank is offline. Please retry later."},"ac03":{"magpie_code":"invalid_destination","magpie_message":"AllBank could not validate the beneficiary account. Please double-check the details."},"ac06":{"magpie_code":"destination_account_blocked","magpie_message":"The receiving account is blocked. Ask the beneficiary to contact their bank."},"be01":{"magpie_code":"beneficiary_details_mismatch","magpie_message":"Beneficiary details do not match the receiving bank's records."},"debtor bank is not registered":{"magpie_code":"debtor_bank_not_registered","magpie_message":"The sending bank is not registered on this network."},"ds07":{"magpie_code":"payout_completed","magpie_message":"Payout settled successfully via AllBank."}}}},"security":[{"basicAuth":[]}]}